# Alert Triage Playbook

## Overview
Step-by-step triage guidance for alerts generated by this project's detection rules.

## Alert Triage Procedures

### Firewall Bruteforce Success (High)
**Detection**: Multiple DENY followed by ALLOW to SSH/RDP ports within 10 minutes.

**Triage Steps**:
1. Run investigation query: [firewall-bruteforce-investigation.spl](/Investigations/firewall-analysis/spl-queries/firewall-bruteforce-investigation.spl)
2. Identify target system (192.168.1.100 for SSH, 192.168.1.21 for RDP)
3. Check timing (10:00 AM for SSH, 3:00 PM for RDP)
4. Block source IP at firewall immediately
5. Reset credentials on affected servers

### Windows RDP Bruteforce (Medium)
**Detection**: 5+ failed logins (EventID 4625) for a single account within 10 minutes.

**Triage Steps**:
1. Run investigation query: [windows-brute-force-investigation.spl](/Investigations/windows-analysis/spl-queries/windows-brute-force-investigation.spl)
2. Check for successful login within 10 minutes
3. Verify account lockout policy
4. Notify account owner

### Windows Admin External Login (Critical)
**Detection**: Admin account login from non-internal source IP.

**Triage Steps**:
1. Run investigation query: [windows-privileged-account-investigation.spl](/Investigations/windows-analysis/spl-queries/windows-privileged-account-investigation.spl)
2. Immediate escalation required
3. Assume credential theft
4. Check for follow-on activity

### Malicious PowerShell Detection (High)
**Detection**: PowerShell with encodedCommand flag or PsExec execution.

**Triage Steps**:
1. Run investigation query: [windows-process-monitoring-investigation.spl](/Investigations/windows-analysis/spl-queries/windows-process-monitoring-investigation.spl)
2. Review command line contents
3. Check for lateral movement attempts
4. Search for encoded commands

### Linux SSH Bruteforce (Medium)
**Detection**: Numerous failed SSH login attempts from single source.

**Triage Steps**:
1. Run investigation query: [linux-brute-force-investigation.spl](/Investigations/linux-analysis/spl-queries/linux-brute-force-investigation.spl)
2. Check for success after failures
3. Identify targeted user
4. Review non-standard port usage

### Linux SSH Root Attack (Critical)
**Detection**: Successful root access after brute force attempts.

**Triage Steps**:
1. Run investigation query: [root-attacks-investigation.spl](/Investigations/linux-analysis/spl-queries/root-attacks-investigation.spl)
2. Immediate containment required
3. Assume full system compromise
4. Begin incident response

## Correlation Steps
When any alert fires:
1. Check same source IP across all platforms
2. Review timeline for related activity
3. Look for data exfiltration patterns

## Escalation Criteria
- **Critical**: Admin/Root access achieved -> Immediate escalation
- **High**: Successful brute force or encoded PowerShell -> Escalate  
- **Medium**: Failed attempts only -> Document and monitor
